O(n + max)
O(n + max)
O(n + max)
